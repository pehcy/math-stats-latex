\ProvidesPackage{styles}
\usepackage{amsmath, nccmath}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{accents}
\usepackage{derivative}
\usepackage{bbm}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[export]{adjustbox}
\newcommand\sbullet[1][.5]{\mathbin{\vcenter{\hbox{\scalebox{#1}{$\bullet$}}}}}
\usepackage{amsthm}
\usepackage{thmtools}
\usepackage{mdframed}
\usepackage{mathtools, cuted}
\usepackage{actuarialsymbol}
\usepackage{tabularx}
\usepackage[dvipsnames]{xcolor,colortbl}
\usepackage{booktabs}
\setlength{\heavyrulewidth}{1.5pt}
\setlength{\abovetopsep}{4pt}
\usepackage{mleftright}
\usepackage{titlesec}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{array}
\usepackage[most]{tcolorbox}
\usepackage{cmupint}
\usepackage{pifont}
\usepackage[colorlinks,linkcolor=blue]{hyperref}
\usepackage[nameinlink]{cleveref}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\cov}{Cov}
\DeclareMathOperator*{\iid}{\overset{\text{iid}}{\sim}}
\DeclareMathOperator*{\corr}{Corr}
\DeclareMathOperator*{\bias}{Bias}
\DeclareRobustCommand{\bxseries}{\fontseries{bx}\selectfont}
\DeclareTextFontCommand{\textbx}{\fontseries{bx}}
\newcommand{\CS}[1]{\textit{SS}_{#1}}
\newcommand{\MS}[1]{\textit{MS}_{#1}}
\newcommand{\Lim}[1]{\raisebox{0.5ex}{\scalebox{0.8}{$\displaystyle \lim_{#1}\;$}}}
\renewcommand{\labelitemi}{{\color{red!70!white}\ding{118}}}

\newcommand\uprob[2][]{\underset{#1}{\mathbb{P}}\mleft[\,#2\,\mright]}
\newcommand\cprob[3][]{\mathbb{P}_{#1}\mleft[\,#2\;\middle\vert\;#3\,\mright]}

\newcommand\uexp[2][]{\underset{#1}{\mathbb{E}}\mleft[\,#2\,\mright]}

%command for alg-closure that automatically adapts its 'bar' to the arg based on the args length (including '\')
\newcommand{\ols}[1]{\mskip.5\thinmuskip\overline{\mskip-.5\thinmuskip {#1} \mskip-.5\thinmuskip}\mskip.5\thinmuskip} % overline short
\newcommand{\olsi}[1]{\,\overline{\!{#1}}} % overline short italic
\makeatletter
\newcommand\closure[1]{
  \tctestifnum{\count@stringtoks{#1}>1} %checks if number of chars in arg > 1 (including '\')
  {\ols{#1}} %if arg is longer than just one char, e.g. \mathbb{Q}, \mathbb{F},...
  {\olsi{#1}} %if arg is just one char, e.g. K, L,...
}

\usepackage{scrlayer}
\DeclareNewLayer[
    foreground,
    %textarea,% use only the textarea
    contents={%
      \parbox[b][\layerheight][c]{\layerwidth}
        {\centering This page 
          intentionally left blank.}%
    }
  ]{blankpage.fg}
\DeclarePageStyleByLayers{blank}{blankpage.fg}

% figure caption
\DeclareCaptionFormat{custom}
{%
    \textsf{\textbf{#1#2}}{\small #3}
}
\captionsetup{format=custom}

\definecolor{myred}{RGB}{240,150,150}
\definecolor{mygreen}{RGB}{150,240,150}
\definecolor{myblue}{RGB}{150,150,255}
\definecolor{mypurple}{RGB}{210,150,255}
\definecolor{myyellow}{RGB}{255,195,0}
\definecolor{mygrey}{RGB}{230,230,230}
\definecolor{lightgrey}{rgb}{.85, .85, .85}

% better hashtag symbol
\newcommand*{\hash}{%
  \begin{tikzpicture}
    % Width: 80% of equal sign
    \pgfmathsetlengthmacro\myWidth{.8*width("=")}%
    % Height: height of uppercase letter
    \pgfmathsetlengthmacro\myHeight{height("H")}%
    % Space between horizontal lines
    \pgfmathsetlengthmacro\mySepY{.3333*\myWidth}%
    % Side bearing
    \pgfmathsetlengthmacro\mySideBearing{.1*\myWidth}%
    % Angle for slanted vertical lines
    \def\myAngle{70}%
    % Calculate separation of vertical lines in horizontal direction
    \pgfmathsetlengthmacro\mySepX{\mySepY/sin(\myAngle)}%
    % Calculate the width of a slanted line
    \pgfmathsetlengthmacro\mySlantX{\myHeight/tan(\myAngle)}%
    \draw[line cap=round]
      (0, {(\myHeight - \mySepY)/2}) -- ++(\myWidth, 0)
      (0, {(\myHeight + \mySepY)/2}) -- ++(\myWidth, 0)
      ({(\myWidth - \mySepX - \mySlantX)/2}, 0)
      -- ({(\myWidth - \mySepX + \mySlantX)/2}, \myHeight)
      ({(\myWidth + \mySepX - \mySlantX)/2}, 0)
      -- ({(\myWidth + \mySepX + \mySlantX)/2}, \myHeight)
    ;%
    \useasboundingbox
      (-\mySideBearing, 0)
      (\myWidth + \mySideBearing, \myHeight)
    ;% 
  \end{tikzpicture}%
}

% draw icon for hypothesis testing chpt
\newcommand{\vertl}{{\color{red} \begin{tikzpicture}[baseline=0.73ex]\draw[red, ultra thick] (0,0) -- (0,0.5);\end{tikzpicture}}}
\newcommand{\horl}{{\color{red} \begin{tikzpicture}[baseline=-0.625ex]\draw[red, ultra thick] (0,0) -- (0.5,0);\end{tikzpicture}}}
\newcommand{\recticon}[1]{
  \begin{tikzpicture}[baseline=0ex] \fill[#1, opacity = 0.35] (0, 0)-- (0, 0.3) -- (0.5, 0.3) -- (0.5, 0); \end{tikzpicture}
}

% Draw geometric symbols
\def\sqPDF#1#2{0 0 m #1 0 l #1 #1 l 0 #1 l h}
\def\trianPDF#1#2{0 0 m #1 0 l #2 4.5 l h}
\def\uptrianPDF#1#2{#2 0 m #1 4.5 l 0 4.5 l h}
\def\circPDF#1#2{#1 0 0 #1 #2 #2 cm .1 w .5 0 m
   .5 .276 .276 .5 0 .5 c -.276 .5 -.5 .276 -.5 0 c
   -.5 -.276 -.276 -.5 0 -.5 c .276 -.5 .5 -.276 .5 0 c h}
\def\diaPDF#1#2{#2 0 m #1 #2 l #2 #1 l 0 #2 l h}

\def\credCOLOR   {.54 .14 0}
\def\cblueCOLOR  {.06 .3 .54}
\def\cgreenCOLOR {0 .54 0}

\def\genbox#1#2#3#4#5#6{% #1=0/1, #2=color, #3=shape, #4=raise, #5=width, #6=width/2
    \leavevmode\raise#4bp\hbox to#5bp{\vrule height#5bp depth0bp width0bp
    \pdfliteral{q .5 w \csname #2COLOR\endcsname\space RG
                       \csname #3PDF\endcsname{#5}{#6} S Q
             \ifx1#1 q \csname #2COLOR\endcsname\space rg 
                       \csname #3PDF\endcsname{#5}{#6} f Q\fi}\hss}}

                                    % shape     raise width  width/2
\def\sqbox      #1#2{\genbox{#1}{#2}  {sq}       {0}   {4.5}  {2.25}}
\def\trianbox   #1#2{\genbox{#1}{#2}  {trian}    {0}   {5}    {2.5}}
\def\uptrianbox #1#2{\genbox{#1}{#2}  {uptrian}  {0}   {5}    {2.5}}
\def\circbox    #1#2{\genbox{#1}{#2}  {circ}     {0}   {5}    {2.5}}
\def\diabox     #1#2{\genbox{#1}{#2}  {dia}      {-.5} {10}    {5}}

%% usage:

% squares: \sqbox0{cgreen}, \sqbox1{cred}, \sqbox0{cblue}.
% triangles: \trianbox0{cgreen}, \trianbox1{cred}, \trianbox0{cblue}.
% triangles: \uptrianbox0{cgreen}, \uptrianbox1{cred}, \uptrianbox0{cblue}.
% circles: \circbox0{cgreen}, \circbox1{cred}, \circbox0{cblue}.
% diamonds: \diabox0{cgreen}, \diabox1{cred}, \diabox0{cblue}.

%\usepackage{mathrsfs}
%\usepackage{titletoc}

\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing,arrows.meta,calc}
\tikzstyle{every picture}+=[remember picture]
\usepackage{pgfplots}
\usepgflibrary{shadings}
\pgfplotsset{compat=1.16}
\usetikzlibrary{arrows,chains,matrix,positioning,scopes,angles,quotes}
\makeatletter

\usepackage{enumerate}
\usepackage[inline]{enumitem}
\usepackage{setspace}
\singlespacing
\setlength{\parindent}{2em}
\setlength{\parskip}{0.5em}

\usepackage{fancybox}
\usepackage{framed}
\usepackage{ragged2e}

%\theoremstyle{definition}
%\newtheorem{definition}{Definition}[section]
% \newtheorem{theorem}{Theorem}[section]
% \newtheorem{axiom}{Axiom}[section]
\newtheorem*{remark}{Remark}
%\newmdtheoremenv{definition}{Definition}[section]

\newcommand\norm[1]{\left\lVert#1\right\rVert}

\newtheoremstyle{break}{0pt}{0pt}{\normalfont}{0pt}{\bfseries}{}{\newline}{\thmname{#1} \thmnumber{#2} \quad \thmnote{\textbf#3}}
\declaretheorem[numberwithin=chapter,style=break,name=Theorem]{theorem}

\tcolorboxenvironment{theorem}{ 
  breakable,
  colback=green!5,
  colframe={green!55!black},
}

\newtheoremstyle{break}{0pt}{0pt}{\normalfont}{0pt}{\bfseries}{}{\newline}{\thmname{#1} \thmnumber{#2} \quad \thmnote{\textbf#3}}
\declaretheorem[numberwithin=chapter,style=break,name=Definition]{definition}

\tcolorboxenvironment{definition}{ 
  breakable,
  colback=red!5,
  colframe={red!55!black},
}

\newtheoremstyle{break}{0pt}{0pt}{\normalfont}{0pt}{\bfseries}{}{\newline}{\thmname{#1} \thmnumber{#2} \quad \thmnote{\textbf#3}}
\declaretheorem[numberwithin=chapter,style=break,name=Lemma]{lemma}

\tcolorboxenvironment{lemma}{ 
  breakable,
  colback=orange!5,
  colframe={orange!55!black},
}

\newtheoremstyle{break}{0pt}{0pt}{\normalfont}{0pt}{\bfseries}{}{\newline}{\thmname{#1} \thmnumber{#2} \quad \thmnote{\textbf#3}}
\declaretheorem[numberwithin=chapter,style=break,name=Axiom]{axiom}

\tcolorboxenvironment{axiom}{ 
  breakable,
  colback=orange!5,
  colframe={orange!55!black},
}

\newtheoremstyle{break}{0pt}{0pt}{\normalfont}{0pt}{\bfseries}{}{\newline}{\thmname{#1} \thmnumber{#2} \quad \thmnote{\textbf#3}}
\declaretheorem[numberwithin=chapter,style=break,name=Corollary]{corollary}

\tcolorboxenvironment{corollary}{ 
  breakable,
  colback=blue!5,
  colframe={blue!55!black},
}

\usepackage{thmtools}

\declaretheoremstyle[
spaceabove=2em, spacebelow=6pt,
headfont={\large \color{fireEngRed} \ding{81} \sffamily\bfseries},
notefont=\mdseries, notebraces={(}{)},
bodyfont=\normalfont,
postheadspace=1em,
numberwithin=section
]{exstyle}
\declaretheoremstyle[
spaceabove=6pt, spacebelow=2em,
headfont={\large \ding{82} \sffamily\bfseries},
notefont=\mdseries, notebraces={(}{)},
bodyfont=\normalfont,
postheadspace=1em,
headpunct={},
qed=$\blacktriangleleft$,
numbered=no
]{solstyle}
\declaretheorem[style=exstyle]{example}
\declaretheorem[style=solstyle]{solution}

%\usepackage[most]{tcolorbox}
%\newtcbtheorem{policy}{Policy Type}{enhanced,frame empty,interior empty,colframe=ForestGreen!50!white,coltitle=ForestGreen!50!black,fonttitle=\bfseries,colbacktitle=ForestGreen!15!white,borderline={0.5mm}{0mm}{ForestGreen!15!white},borderline={0.5mm}{0mm}{ForestGreen!50!white,dashed},attach boxed title to top center={yshift=-2mm},boxed title style={boxrule=0.4pt},varwidth boxed title}{th}
%\newtcbtheorem{policy}{Policy Type}{fonttitle=\bfseries\upshape,fontupper=\itshape,colframe=blue!0!black,colback=white!99,colbacktitle=blue!20!white,coltitle=blue!75!black}{th}

\usepackage[lastexercise,answerdelayed]{exercise}
\counterwithin{Exercise}{chapter}
\counterwithin{Answer}{chapter}
\newcommand{\AtBeginExerciseHeader}{\hspace{-0.75cm}}
\renewcommand{\ExerciseHeader}{\AtBeginExerciseHeader \textbf{\ExerciseHeaderDifficulty \ExerciseName~\ExerciseHeaderNB} \quad }
%\renewcommand{\ExerciseHeader}{\textbf{\ExerciseName~\ExerciseHeaderNB}\quad}
\renewcommand{\AnswerHeader}{\AtBeginExerciseHeader \textbf{\AnswerName~\ExerciseHeaderNB}\smallskip\newline}

\titleformat{\chapter}[display]
  {\fontfamily{qhv}\selectfont\bfseries\large\filright}
  {\hrule height 0pt \Huge\color{fireEngRed}\thechapter\hrule}
  {-\baselineskip}
  {\Huge\strut}
\titlespacing*{\chapter}
  {0pt}
  {-\topskip}
  {2\normalbaselineskip}

%\titleformat{\chapter}
%  {\normalfont\LARGE\bfseries}{\thechapter}{1em}{}
%\titlespacing*{\chapter}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}

\usepackage{tgpagella}

%\usepackage[scale=.94]{tgheros} % Sans font is TG-Heros
%\usepackage{inconsolata} % mono-spaced font

%\usepackage{mathptmx, newtxmath}
%\usepackage{libertine}
%\usepackage[T1]{fontenc}
%\usepackage[libertine]{newtxmath}

%\usepackage{fontspec}
%\setsansfont{Archia-Regular}[Path=src/fonts/, Extension=.otf]
%\usepackage{unicode-math}
%\setmainfont{Source Serif Pro} % Sets the text font

%\setmathfont{texgyretermesmath} % Sets the text font
% \setmainfont{Source Serif Pro} % Sets the text font
% \setmathfont{Heuristica}       % Sets the math font
% \usepackage[scaled=0.85]{DejaVuSansMono}
\usepackage{minted}

%% Section/Subsection Font Family
\titleformat{\section}
  {\fontfamily{qhv}\selectfont\bfseries\Large}
  {\thesection}
  {1em}
  {}
\titleformat{\subsection}
  {\fontfamily{qhv}\selectfont\bfseries\large}
  {\thesubsection}
  {1em}
  {}

\usepackage[most]{tcolorbox}
\tcbuselibrary{minted,skins}

\newtcblisting{pycode}[1][]{
  listing engine=minted,
  colback=pybg,
  colframe=white,
  listing only,
  minted style=manni,
  minted language=python,
  minted options={linenos=true,numbersep=3mm,texcl=true,baselinestretch=1.1, #1}
}

\newtcblisting{rcode}{
  listing engine=minted,
  colback=codeblockbg,
  colframe=black!50,
  listing only,
  minted style=pastie,
  minted language=r,
  minted options={linenos=true,numbersep=3mm,texcl=true,baselinestretch=1.1},
  left=5mm,enhanced,
  overlay={\begin{tcbclipinterior}\fill[black!25] (frame.south west)
            rectangle ([xshift=5mm]frame.north west);\end{tcbclipinterior}}
}

\definecolor{codeblockbg}{rgb}{0.97,0.97,0.97}

\definecolor{pybg}{rgb}{0.98,0.98,0.98}
%\newminted{pycon}{bgcolor=pybg, linenos=true, tabsize=4}
%\usemintedstyle{vs}
